<li>
    <a href="/"
       class="px-3 py-2 font-medium text-gray-700 hover:text-gray-900 rounded-md hover:bg-gray-50 transition-colors focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cta-dark">{{ 'menu.home'|trans }}</a>
</li>
{% for item in items %}
    {% if item.children|length == 0 %}
        <li>
            <a href="{{ item.parent.url }}"
               class="px-3 py-2 font-medium text-gray-700 hover:text-gray-900 rounded-md hover:bg-gray-50 transition-colors focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cta-dark">
                {{ item.parent.name }}
            </a>
        </li>
    {% else %}
        <li class="relative" x-data="{ open: false }">
            <button
                    type="button"
                    class="cursor-pointer inline-flex items-center gap-1 px-3 py-2 font-medium text-gray-700 hover:text-gray-900 rounded-md hover:bg-gray-50 transition-colors focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cta-dark"
                    aria-haspopup="true"
                    :aria-expanded="open.toString()"
                    @click="open = !open"
                    @keydown.escape.prevent="open = false"
                    @keydown.arrow-down.prevent="open = true; $nextTick(() => $refs.sorganiserMenu.querySelector('a').focus())"
            >
                {{ item.parent.name }}
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"
                     class="size-4 transition-transform" :class="open && 'rotate-180'">
                    <path fill-rule="evenodd"
                          d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                          clip-rule="evenodd"/>
                </svg>
            </button>
            <ul
                    x-ref="sorganiserMenu"
                    x-show="open"
                    x-transition:enter="transition ease-out duration-150"
                    x-transition:enter-start="opacity-0 translate-y-1"
                    x-transition:enter-end="opacity-100 translate-y-0"
                    x-transition:leave="transition ease-in duration-100"
                    x-transition:leave-start="opacity-100 translate-y-0"
                    x-transition:leave-end="opacity-0 translate-y-1"
                    @click.away="open = false"
                    @keydown.escape.prevent="open = false; $el.parentElement.querySelector('button').focus()"
                    @keydown.arrow-down.prevent="$event.target.closest('li').nextElementSibling?.querySelector('a')?.focus()"
                    @keydown.arrow-up.prevent="$event.target.closest('li').previousElementSibling?.querySelector('a')?.focus() || $el.parentElement.querySelector('button').focus()"
                    @keydown.tab="open = false"
                    class="list-none absolute left-0 top-full mt-1 w-48 bg-white rounded-md shadow-lg ring-1 ring-black/5 py-1 z-50"
                    x-cloak
            >
                {% for child in item.children %}
                    <li>
                        <a href="{{ child.url }}"
                           class="block px-4 py-2.5 text-gray-700 hover:bg-gray-100 focus-visible:bg-gray-100 focus-visible:outline-none">
                            {{ child.name }}
                        </a>
                    </li>
                {% endfor %}
            </ul>
        </li>
    {% endif %}
{% endfor %}
<li>
    <button
            @click="openSearchModal()"
            class="cursor-pointer inline-flex items-center gap-2 px-3 py-2 text-gray-500 hover:text-gray-700 transition-colors rounded-md hover:bg-gray-50 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cta-dark"
            aria-label="{{ 'menu.search'|trans }}"
            type="button">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
             aria-hidden="true" class="size-5">
            <path stroke-linecap="round" stroke-linejoin="round"
                  d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"/>
        </svg>
        <span class="sr-only">Rechercher</span>
        <kbd class="hidden lg:inline-flex items-center px-1.5 py-0.5 text-xs font-semibold text-gray-500 bg-gray-100 border border-gray-300 rounded">Ctrl
            K</kbd>
    </button>
</li>
